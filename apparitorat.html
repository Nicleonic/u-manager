<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
       <!-- style -->
       <link rel="stylesheet" href="style.css">
       <link rel="stylesheet" href="inscript.css">
       <!-- bootstrap -->
       <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">
       <!-- fontAwesome -->
       <link rel="stylesheet" href="node_modules/fontweb/css/all.css">
       <link rel="stylesheet" href="node_modules/fontweb/css/all.min.css">
    <link rel="stylesheet" href="owlcarousel/assets/owl.carousel.min.css">
    <title>U-M | Apparitorat</title>
</head>
<body >  

    <div class="container-blur" id="inscr-form">
        <div class="inscr-form">
            <div class="cancel_btn py-0 " id="student_Cancel" onclick={removeSignDisplay()}>
                <span><i class="fas fa-xmark"></i></span>
            </div>
            <div class="staff-title py-0 h-auto p-0">
                <h2>Inscription du nouvel étudiant</h2>
            </div>
            <div class="signin py-0">
                <form action="#" method="POST">
                    <div class="inputs-datas py-0 my-0">
                        <h3 style="text-align: center;padding: 3% 0%;">Identités</h3>
                        <fieldset class="form-group">
                            <!-- <legend>Identité du (de la) candidat (e)</legend> -->
                            
                            <div class="form-group i-group">
                                <label for="name" class="form-label">Nom</label>
                                <input type="text" class="form-control" name="nom"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Post-nom</label>
                                <input type="text" class="form-control" name="postnom"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Prénom</label>
                                <input type="text" class="form-control" name="prenom"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Sexe</label>
                                <select class="form-select form-control" name="sexe" >
                                  <option  selected value="M">Masculin</option>
                                  <option value="F">Féminin</option>
                                </select>
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Lieu de naissance</label>
                                <input type="text" class="form-control" name="lnaissance"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Date de naissance</label>
                                <input type="date" class="form-control" name="dnaissance"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Nom du Père</label>
                                <input type="text" class="form-control" name="pere_nom"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Tel. du Père </label>
                                <input type="text" class="form-control" name="pere_tel"   placeholder="" required> 
        
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Nom de la mère</label>
                                <input type="text" class="form-control" name="mere_nom"  placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Tel. de la Mère</label>
                                <input type="text" class="form-control" name="mere_tel"   placeholder="" required> 
                            </div>
                        </fieldset>
                        <fieldset class="origine">
                            <!-- <legend>Origine</legend> -->
                            <div class="form-group i-group">
                                <label for="" class="form-label">Pays d'origine</label>
                                <input type="text" class="form-control" name="pays_origine"  placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Province d'origine</label>
                                <input type="text" class="form-control" name="province_origine"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Territoire d'origine</label>
                                <input type="text" class="form-control" name="territoire_origine"   placeholder="" required> 
                            </div>
                        </fieldset>
                        <fieldset class="religion">
                            <!-- <legend>Opinion Réligieuse</legend> -->
                            <div class="form-group i-group">
                                <label for="" class="form-label">Confession réligieuse</label>
                                <input type="text" class="form-control" name="religion"  placeholder="" required> 
                            </div>
                            <div class="form-group">
                                <label for=""  class="form-label">Langues</label>
                                <input type="text" name="langues" class="form-control"   placeholder="" required> 
                            </div>
                        </fieldset>
                        <fieldset class="adresseActuelle">
                            <!-- <legend>Adresse Actuelle du (de la) candidat (e)</legend> -->
                            <div class="form-group i-group">
                                <label for="" class="form-label">Ville</label>
                                <input type="text" class="form-control" name="ville_actuelle"  placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Commune</label>
                                <input type="text" class="form-control" name="commune_actulle"  placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Quartier</label>
                                <input type="text" class="form-control" name="quartier_actuel"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Téléphone</label>
                                <input type="text" class="form-control" name="telephone"  placeholder="" required> 
                            </div>
                        </fieldset>
                        <h3 style="text-align: center;padding: 3% 0%;">Demande d'inscription</h3>
                        <fieldset class="filiereChoice">
                            <!-- <legend>Choix de filière</legend> -->
                            <div class="mb-3">
                                <label for="" class="form-label">Faculté</label>
                                <select class="form-select form-select-sm" id="faculte" aria-label=".form-select-sm example">
                                  
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="" class="form-label">Département</label>
                                <select class="form-select form-select-sm" name="departement" id="departement" aria-label=".form-select-sm example">
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="" class="form-label">Promotion</label>
                                <select class="form-select form-select-sm" name="promotion" id="promotion" aria-label=".form-select-sm example">                                  
                                </select>
                            </div>
                            <div class="mb-3">
                          
                        </fieldset>
                        <h3 style="text-align: center;padding: 3% 0%;">Ecole secondaire</h3>
                        <fieldset class="high-school">
                            <!-- <legend>Etudes sécondaires faites</legend> -->
                            <div class="form-group i-group">
                                <label for="" class="form-label">Nom de l'école fréquentée</label>
                                <input type="text" name="ecole_secondaire" class="form-control"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Section faite</label>
                                <input type="text" class="form-control" name="section_secondaire"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Année d'obtention du diplôme</label>
                                <input type="text" class="form-control" name="annee_diplome"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Pourcentage du diplôme d'Etat</label>
                                <input type="number" class="form-control" name="pourcentage_diplome"   placeholder="" required> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Numéro du diplôme d'Etat</label>
                                <input type="number" class="form-control" name="numero_diplome"   placeholder="" required> 
                            </div>
                        </fieldset>
                        
                        
                        <fieldset class="afterHighschool">
                            <!-- <legend>Occupations après les humanités</legend> -->
                            <div class="form-group i-group">
                                <label for="" class="form-label">Activités professionnelles</label>
                                <input name="profession" id="" cols="80" rows="5" class="form-control">
                            </div>
                        </fieldset>
                        <h3 style="text-align: center;padding: 3% 0%;">Etudes universitaires antérieures</h3>
                        <fieldset class="univBefore">
                            
                            <div class="form-group i-group">
                                <label for="" class="form-label">Année académique</label>
                                <input type="number" name="last_annee_academique" class="form-control"   placeholder=""> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Etablissement</label>
                                <input type="text" name="last_etablissement" class="form-control"   placeholder=""> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Promotion</label>
                                <input type="number" name="last_promotion" class="form-control"   placeholder=""> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Département</label>
                                <input type="text" class="form-control" name="last_faculte"   placeholder=""> 
                            </div>
                            <div class="form-group i-group">
                                <label for="" class="form-label">Faculté</label>
                                <input type="text" class="form-control" name="last_faculte"   placeholder=""> 
                            </div>
                        </fieldset>
                        
                        <h3 style="text-align: center;padding: 3% 0%;">Documents</h3>
                        <fieldset class="prerequis">
                            
                            <div class="form-group i-group-check">
                                <div class="form-group i-group">
                                    <label for="" class="form-label">Attestation du diplôme</label>
                                    <input type="checkbox" name="at_diplome_secondaire" id="">
                                </div>
                                <div class="form-group i-group">
                                    <label for="" class="form-label">Relevés (Pour les ancians etudiants)</label>
                                    <input type="checkbox" name="at_releve" id="">
                                </div>
                                <div class="form-group i-group">
                                    <label for="" class="form-label">Attestation de bonnes moeurses</label>
                                    <input type="checkbox" name="at_bonnes_moeurses" id="">
                                </div>
                                <div class="form-group i-group">
                                    <label for="option" class="form-label">Attestation d'engagement</label>
                                    <input type="checkbox" name="at_engagement" id="option">
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <div class="actionsValidation pb-0  mb-0">
                        <!-- student signup validation -->
                        <button class="btn btn-log w-50 " id="studentSV" type="submit">Valider</button>
                    </div>      

                </form>
            </div>
            <!-- student creation formular end -->
        </div>
        
    </div>
    <!-- Inscription END -->
    <header>
        <div class="head-content ">
            <div class="title ">
                <h2>Apparitorat</h2>
            </div>
            <div class="actions">
                <button onclick="window.open('index.html','_self')" class="btn btn-log"><i class="fa-solid fa-home"></i></button>
                <button class="btn btn-log"><i class="fa-solid fa-right-from-bracket"></i></button>
            </div>
        </div>
    </header>    
    <section class="body-container">
       <div class="body-content">
            <div class="content" id="signBn">
                <!-- <div class="content" onclick="window.open('inscription.html','_self')" id="signBn"></div> -->
                <h3>Inscription</h3>
            </div>
            <div class="content" onclick="window.open('find.html','_self')">
                <h3>Etudiants Inscrits</h3>
            </div>
            <div class="content" onclick="alert('fonctionnalité non disponible')">
                <h3>Etudiants validés</h3>
            </div>
            <div class="content" onclick="alert('fonctionnalité non disponible')">
                <h3>Gestion de cours</h3>
            </div>
            <div class="content" onclick="window.open('admin.html','_self')">
                <h3>Administration</h3>
            </div>
            
       </div>
    </section>
    <script src="script.js"></script>
    <script src="src/jquery.min.js"></script>

    <script>
        let signUpBtn = document.getElementById('signBn');
        let inscrire = document.getElementById('signEtud');
        let signupDisplay = document.getElementById('inscr-form');
        let cancelSignup = document.getElementById('student-cancel');
        let signupValidation = document.getElementById('studentSV')

        signUpBtn.addEventListener('click', ()=>{
            signupDisplay.classList.add('active');
        })

        function removeSignDisplay(){
            signupDisplay.classList.remove('active');
        }
        
        $("#faculte").change(function (e) { 
            e.preventDefault();
            setDepartement($(this).val())
        });
        $.get("server/", {"faculte-all":""},
            function (data, textStatus, jqXHR) {
                data.forEach(element => {
                    $("#faculte").append('<option value='+element["id"]+'>'+element["nom_complet"]+'</option>');
                });
                
                setDepartement(data[0]["id"])
            },
            "json"
        );
        $.getJSON("server/", {"promotion-all":""},
            function (data, textStatus, jqXHR) {
                data.forEach(element => {
                    $("#promotion").append('<option value="'+element["id"]+'">'+element["nom_complet"]+'</option>');
                })
            }
        );
        function setDepartement(id) {
            $("#departement").html("");
            $.post("server/?departement-search", {'id_faculte':id},
                    function (data, textStatus, jqXHR) {
                        data.forEach(element => {
                            $("#departement").append('<option value="'+element["id"]+'">'+element["nom_complet"]+'</option>');
                        });
                    },
                    "json"
                );
        }
        $("form").submit(function (e) { 
            e.preventDefault();
            let formData=new FormData(this)
            let dict={}
            for(var i of formData.entries()){
                dict[i[0]]=i[1];
            }
            console.log(dict);
            $.ajax({
                type: "POST",
                url: "server/?etudiant_0-new",
                data: dict,
                dataType: "json",
                success: function (response) {
                    removeSignDisplay()
                    alert(response.message)
                    console.log(response);
                }
            });
        });
    </script>
    <!-- <script src="owlcarousel/owl.carousel.js"></script>
    <script src="owlcarousel/owl.carousel.min.js"></script> -->
</body>
</html>