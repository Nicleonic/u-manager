<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <!-- bootstrap -->
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.css">
    <!-- fontAwesome -->
    <link rel="stylesheet" href="node_modules/fontweb/css/all.css">
    <link rel="stylesheet" href="node_modules/fontweb/css/all.min.css">
    <!-- OwlCarousel -->
    <link rel="stylesheet" href="owlcarousel/assets/owl.carousel.min.css">
    <title>U-M | Apparitorat/student</title>
</head>
<body >
    <style>
        :root{
            /* --primary:rgba(27, 62, 70, 1); */
            --primary: rgba(91, 87, 174);
            --bglv:rgba(91, 87, 174);
            --bglt:rgb(255, 120, 0);
            --btnbg: rgb(37, 42, 106);
            --secondary:rgb(235, 240, 245);
        }
        .student-info{
            border: 2px solid black;
            position: relative;

        }
        .student-info .stud-header{
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 0;
        }
        .stud-header *{
            border: 0px solid rebeccapurple;
        }
        .stud-header .first-id{
            width: 80%;
            border: 0px dashed blue;
        }
        .stud-header {
            border: 0px solid rgb(161, 16, 0);
        }
   
        .first-id ul{
            list-style: none;

        }
        .first-id ul li{
            list-style: none;
            font-size: 1.2rem;
        }
        .first-id ul li span{
            list-style: none;
            font-size: 1.2rem;
            border: 0px solid darkgreen;
            color: var(--primary);
        }
        .student-info .id-title{
            font-size: 1.2rem;
            font-weight: bold;
            padding-left: 2rem;
        }
        .student-info .id-title ul li span{
            color: var(--primary);
        }
        .stud-header .photo{
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0;
            margin: 0;
            border: 0px solid violet;
            height: auto;
            width: 20%;
        }
        div::-webkit-scrollbar{
            height: .4rem;
        }
        .stud-header .photo .container-img{
            height: 100%;
            width: 100%;
            position: relative;

        }
        .stud-header .photo .container-img {
           position: relative;
           display: flex;
           flex-direction: column;
            border: 0px dotted rgb(161, 16, 0);
            height: 100%;
            width: 100%;
            overflow-x: auto;

        }
        .stud-header .photo .container-img .img{
            overflow-x: auto;
            height: 16rem;
            width: 100%;
            min-width: 12rem;
            background-image: url(img/user.png);
            background-position: center;
            background-size: cover;
        }
        .stud-header .photo .container-img .bottom{
            width: 100%;
        }
        .stud-header .photo .container-img .bottom ul{
            list-style: none;
            display: flex;
            justify-content: space-around;
        }
        .stud-header .photo .container-img .bottom ul li{
            list-style: none;
        }
        .container-st{
            border: 0px solid saddlebrown;
            display: flex;
        }
        .container-st .left{
            border: 0px solid darkcyan;
            width: 80%;
        }
        .container-st .right{
            width: 20%;
            border: 0px solid darkblue;
        }
        .container-st .right ul{
            border: 0px solid darkcyan;
            padding: 0;
            margin: 0;
            padding-left: auto;
            padding-right: auto;
            display: flex;
            justify-content: space-around;

        }
        .container-st .right ul li{
            list-style: none;
            display: inline;
  
            
        }
        .container-st .left ul{
            list-style: none;
        }
        .container-st .left ul li{
            list-style: none;
            font-size: 1.2rem;
        }
        .stud-header .first-id ul li span,
        .container-st .left ul li span{
            font-size: 1.2rem;
            font-weight: bolder;
        }
        ul{
            display: grid;
            row-gap: 2px;
        }
        li{
            display: grid;
            grid-template-columns: 30% auto;
            align-items: center;
            row-gap: 2px;
            background: rgba(0, 0, 0, 0.842);
            color: white;
            padding: 5px;
            /* gap: 100px; */
        }
        li>span{
            border-bottom: solid 0px black;
        }
        /* ----------------------------- valide student ------------- */ 
        .st-valide{
            top: 0;
            left: 0;
            right: 0;
            z-index: 105;
            position: fixed;
            backdrop-filter: blur(10px);
            height: 100vh;
            max-height: 100vh;
            width: 100%;
            justify-content: center;
            display: flex;
            align-items: center;
            visibility: hidden;
            transition: .5s ease;
        }
        .st-valide.active{
            visibility: visible;
            transition: all ease-in .5s;
        }
        .st-valide .container{
            border: 0px solid darkblue;
            background: rgba(255, 255, 255, 0.922);
            z-index: 3;
            height: auto;
            min-height: 50vh;
            height: auto;
            width: 500px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 8px rgba(0,0,0,0.4) ;
            padding: 30px;
            border-radius: 10px;
            padding: 1rem  2%;
            transform-origin: center;
        }
    </style>

    <!-- ------------------------  VALIDE Student start -->
    <div class="st-valide" id="val_Display" >
        <div class="container">
            <div class="cancel_btn " style="display: flex;justify-content: center;cursor: pointer;" onclick={removeValDisplay()} id="val_Cancel">
                <span><i class="fas fa-xmark"></i></span>
            </div>
            <div class="staff-title" style="display: flex;justify-content: center;">
                <h2 style="font-size: 1.2rem;font-weight: lighter;">Valider Etudiant</h2>
            </div>
            <div class="staff-form">
                <form action="">
                    <div class="form-group " style="display: flex;flex-direction: column;">
                        <label for="" class="form-label mb-0">Promotion</label>
                        <select class="form-select form-select-sm mb-2" >
                            <option  selected value="1">FSQ</option>
                            <option value="2">FATSIC</option>
                            <option value="3">FATSIC</option>
                            <option value="4">FATSIC</option>
                        </select>
                        <label for="" class="form-label mb-0">Département</label>
                        <select class="form-select form-select-sm mb-2" >
                            <option  selected value="1">FSQ</option>
                            <option value="2">FATSIC</option>
                            <option value="3">FATSIC</option>
                            <option value="4">FATSIC</option>
                        </select>
                        <label for="" class="form-label mb-0">Faculté</label>
                        <select class="form-select form-select-sm mb-2" >
                            <option  selected value="1">FSQ</option>
                            <option value="2">FATSIC</option>
                            <option value="3">FATSIC</option>
                            <option value="4">FATSIC</option>
                        </select>
                        
                    </div>
                    <div class="validation-controls" style="display: flex;justify-content: center;">
                        <button id="st_valider" class=" btn btn-log w-50" type="submit" onclick={removeValDisplay()} style="color: white;">Enregistrer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

     <!-- ------------------------- VALIDE Student end --> 


    <header>
        <div class="head-content">
            <div class="title">
                <h2>Apparitorat</h2>
            </div>
            <div class="actions" onclick="window.open('find.html','_self')">
                <button class="btn btn-log"><i class="fa-solid fa-arrow-left"></i></button>
            </div>


        </div>
    </header>
    
    <section class="body-container">
     
        <div class="student-info" style="border: 0px solid rgb(0, 0, 0);">
            

            <div class="stud-header " style="display: flex;align-items:flex-start;border: solid blue 0px;">
                <div class="photo">
                    <div class="container-img " style="border: none;display: grid; gap: 10px;">
                        <div class="img">

                        </div>
                        <div class="right" >
                            <ul style="display: flex; gap: 5%;">
                                <!-- <li class="tt" data-bs-placement="top" title="Valider"> -->
                                    <button class="btn btn-success tt" id="valide" data-bs-placement="top" title="Valider"> <i class="fa-solid fa-check"></i></button>
                                <!-- </li> -->
                                <!-- <li class="tt" data-bs-placement="top" title="Modifier"> -->
                                    <button class="btn btn-primary tt" id="modify" data-bs-placement="top" title="Modifier"> <i class="fa-solid fa-edit"></i></button>
                                <!-- </li> -->
                                <!-- <li class="tt" data-bs-placement="top" title="Supprimer"> -->
                                    <button class="btn btn-danger tt" id="del" data-bs-placement="top" title="Supprimer" onclick="alert('fonctionnalité non disponible')"> <i class="fa-solid fa-trash"></i></button>
                                <!-- </li> -->
                            </ul>
                        </div>
                    </div>
                    
                </div>
                <!-- ids Student -->
                <div class="first-id">
                    <h2 class="id-title">Identités de l'Etudiant</h2>
                    <ul>
                        <li>Nom      : <span id="nom">......</span></li>
                        <li>Post-Nom : <span id="postnom">......</span></li>
                        <li>Prénom   : <span id="prenom">......</span></li>
                        <li>Sexe     : <span id="sexe">......</span></li>
                        <li>Matt.    : <span id="matricule">......</span></li>
                        <li>Promotion     : <span id="promotion">......</span></li>
                        <li>Département   : <span id="departement">......</span></li>
                        <li>Faculté       : <span id="faculte">......</span></li>
                        <li>Téléphone       : <span id="telephone">......</span></li>
                    </ul>
                    <h2 class="id-title">Adresses</h2>
                    <ul>
                        <li>Ville   : <span id="ville_actuelle"></span> </li>
                        <li>Commune :  <span id="commune_actulle"></span></li>
                        <li>Quartier    :  <span id="quartier_actuel"></span></li>
                        <li>Pays d'origine     : <span id="pays_origine">......</span></li>
                        <li>Province d'origine    : <span id="province_origine">......</span></li>
                        <li>Territoire d'origine     : <span id="territoire_origine">......</span></li>
                    </ul>
                    
                    <h2 class="id-title">Ecole secondaire</h2>
                    <ul>
                        <li>Nom de l'école frequentée    :  <span id="ecole_secondaire"></span></li>
                        <li>Section faite    :  <span id="section_secondaire"></span></li>
                        <li>Année d'obtention du diplôme    :  <span id="annee_diplome"></span></li>
                        <li>Pourcentage du diplôme    :  <span id="pourcentage_diplome"></span></li>
                        <li>Numéro du diplôme d'Etat    :  <span id="numero_diplome"></span></li>
                        
                    </ul>
                    <h2 class="id-title">Université de provenance</h2>
                    <ul>
                        <li>Année académique    :  <span id="last_annee_academique"></span></li>
                        <li>Etablissement    :  <span id="last_etablissement"></span></li>
                        <li>Promotion    :  <span id="last_promotion"></span></li>
                        <li>Département    :  <span id="last_departement"></span></li>
                        <li>Faculté   :  <span id="last_faculte"></span></li>
                    </ul>
                    <h2 class="id-title">Documents requis</h2>
                    <ul>
                        <li>Attestation du diplôme     : <span id="at_diplome_secondaire">......</span></li>
                        <li>Attestation de bonnes moeurses  : <span id="at_bonnes_moeurses">......</span></li>
                        <li>Attestation d'engagement     : <span id="at_engagement">......</span></li>
                        <li>Relevés (pour ancients)  : <span id="at_releve">......</span></li>
                    </ul>

                    <h2 class="id-title">Autres infos</h2>
                    <ul>
                        <li>Nom du Père     : <span id="pere_nom">......</span></li>
                        <li>Tél. du Père  : <span id="pere_tel">......</span></li>
                        <li>Nom de la Mère : <span id="mere_nom">......</span></li>
                        <li>Tél. de la Mère  : <span id="mere_tel">......</span></li>
                        <li>Confession religieuse   : <span id="religion">......</span></li>
                        <li>Langues parlée(s)       : <span id="langues">......</span></li>
                        <li>Activités professionnelles   :  <span id="profession"></span></li>    
                    </ul>
                </div>
                

            </div>

            

        </div>
    
    </section>
    <script src="src/jquery.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // student valid
        let valDisplay =document.getElementById('val_Display')
        let valBtn = document.getElementById('valide');

        valBtn.addEventListener('click', ()=>{
            valDisplay.classList.add('active');
        })
        function removeValDisplay(){
            valDisplay.classList.remove("active");
        }
        $("#modify").click(function (e) { 
            e.preventDefault();
            valDisplay.classList.add('active');
        });

        // toolTip
        const tooltips =document.querySelectorAll('.tt')
        tooltips.forEach(t => {
          new bootstrap.Tooltip(t)
        })
        // toolTip end
        let req=window.location.search
        let ID;
        if (req.search("id=")) {
            let id=req.split("=")[1]

            console.log(id);
            $.get("server/", {"etudiant_0-byId":id},
                function (data, textStatus, jqXHR) {
                    data=data.data
                    if (data.length>0) {
                        data.forEach(element => {
                            console.log(element);
                            const keys = Object.keys(element);
                            console.log(keys);
                            for(var i of keys){
                                console.log(i);
                                if (element[i]=="" || element[i]=="0" || element[i]=="off") {
                                    element[i]='<i class="fa-solid fa-close" style="color:red"></i>'
                                }
                                if (element[i]=="on") {
                                    element[i]='<i class="fa-solid fa-check"></i>'
                                    $("#"+i).html(element[i]);
                                }
                                $("#"+i).html(element[i]);                           
                            }
                        });
                    } else {
                        window.open("find.html","_self")
                    }
                    $.get("server/", {'departement-byId':$("#departement").text()},
                        function (data, textStatus, jqXHR) {
                            console.log(data);
                            $("#departement").text(data.data[0].nom_complet);
                            $.get("server/", {'faculte-byId':data.data[0].id_faculte},
                                function (data1, textStatus, jqXHR) {
                                    console.log(data1);
                                    $("#faculte").text(data1.data[0].nom_complet);
                                    
                                },
                                "json"
                            );
                        },
                        "json"
                    );
                    $.get("server/", {'promotion-byId':$("#promotion").text()},
                        function (data, textStatus, jqXHR) {
                            console.log(data);
                            $("#promotion").text(data.data[0].nom_complet);
                        },
                        "json"
                    );
                    // console.log(data);
                },
                "json"
            );

        }else{
            window.open("find.html","_self")
        }
        $("#st_valider").click(function (e) { 
            e.preventDefault();
            $.post("server/?etudiant_1-new", {matricule:Date.now()/10000000,id:req.split("=")[1],departement:$("#departement").text(),promotion:$("#promotion").text(),},
                function (data, textStatus, jqXHR) {
                    alert(data.message)
                },
                "json"
            );
        });
        console.log(window.location.search.search("id="));
    </script>
</body>
</html>
